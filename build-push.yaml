steps:
  # Step 1: Build Docker image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/$PROJECT_ID/hello-world:$SHORT_SHA', '.']
    dir: 'app'

  # Step 2: Push the image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/$PROJECT_ID/hello-world:$SHORT_SHA']

# Specify custom service account
serviceAccount: 'projects/$PROJECT_ID/serviceAccounts/my-build-sa@$PROJECT_ID.iam.gserviceaccount.com'

images:
  - 'gcr.io/$PROJECT_ID/hello-world:$SHORT_SHA'

options:
  logging: CLOUD_LOGGING_ONLY  # Logs only to Cloud Logging (default bucket)
